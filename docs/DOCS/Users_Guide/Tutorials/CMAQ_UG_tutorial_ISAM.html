
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="../../../_static/CMAQ_Logo_2_inch.png" sizes="600x593" rel="icon" type="image/png">
    <title>CMAQ-ISAM Benchmark Tutorial &#8212; CMAQ 5.5+ documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../_static/documentation_options.js?v=eec9c716"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'DOCS/Users_Guide/Tutorials/CMAQ_UG_tutorial_ISAM';</script>
    <link rel="canonical" href="https://usepa.github.io/CMAQ/DOCS/Users_Guide/Tutorials/CMAQ_UG_tutorial_ISAM.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/CMAQ_Logo_2_inch.png" class="logo__image only-light" alt="CMAQ 5.5+ documentation - Home"/>
    <img src="../../../_static/CMAQ_Logo_2_inch.png" class="logo__image only-dark pst-js-only" alt="CMAQ 5.5+ documentation - Home"/>
  
  
</a></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/USEPA/CMAQ" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.epa.gov/cmaq" title="CMAQ - EPA Site" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../../_static/epa_seal_w-ring_RGB-sm.png" class="icon-link-image" alt="CMAQ - EPA Site"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://forum.cmascenter.org/" title="User Forum" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../../_static/cmas_logo.png" class="icon-link-image" alt="User Forum"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://usepa.github.io/CRACMM/" title="CRACMM" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../../_static/CRACMM_1.png" class="icon-link-image" alt="CRACMM"/></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/CMAQ_Logo_2_inch.png" class="logo__image only-light" alt="CMAQ 5.5+ documentation - Home"/>
    <img src="../../../_static/CMAQ_Logo_2_inch.png" class="logo__image only-dark pst-js-only" alt="CMAQ 5.5+ documentation - Home"/>
  
  
</a></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/USEPA/CMAQ" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.epa.gov/cmaq" title="CMAQ - EPA Site" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../../_static/epa_seal_w-ring_RGB-sm.png" class="icon-link-image" alt="CMAQ - EPA Site"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://forum.cmascenter.org/" title="User Forum" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../../_static/cmas_logo.png" class="icon-link-image" alt="User Forum"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://usepa.github.io/CRACMM/" title="CRACMM" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../../_static/CRACMM_1.png" class="icon-link-image" alt="CRACMM"/></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Getting_Started.html">Getting Started</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../README.html">CMAQ User’s Guide</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../CMAQ_UG_ch01_overview.html">1. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CMAQ_UG_ch02_program_structure.html">2. Program Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CMAQ_UG_ch03_preparing_compute_environment.html">3. Preparing Compute Environment for CMAQ Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CMAQ_UG_ch04_model_inputs.html">4. Model Input Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CMAQ_UG_ch05_running_a_simulation.html">5. Running a CMAQ Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CMAQ_UG_ch06_model_configuration_options.html">6. Model Configuration Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CMAQ_UG_ch07_model_outputs.html">7. Model Output Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CMAQ_UG_ch08_analysis_tools.html">8. Analysis Tools for CMAQ output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CMAQ_UG_ch09_process_analysis.html">9. Process Analysis and Budget</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CMAQ_UG_ch10_HDDM-3D.html">10. Decoupled Direct Method in Three Dimensions (CMAQ-DDM-3D)</a></li>




<li class="toctree-l2"><a class="reference internal" href="../CMAQ_UG_ch11_ISAM.html">11. Integrated Source Apportionment Method (CMAQ-ISAM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CMAQ_UG_ch12_sulfur_tracking.html">12. Sulfur Tracking Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CMAQ_UG_ch13_WRF-CMAQ.html">13. WRF-CMAQ Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CMAQ_UG_ch14_MPAS-CMAQ.html">14. MPAS-CMAQ Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Appendix/README.html">Appendix</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="README.html">CMAQ Tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="CMAQ_UG_tutorial_configure_linux_environment.html">Configuring your compute environment for CMAQ simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="CMAQ_UG_tutorial_running_benchmarks.html">CMAQ Benchmark Tutorials</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Release_Notes/README.html">Release Notes</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Release_FAQ/README.html">FAQs</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Release_FAQ/CMAQv5.5-Series-FAQ.html">FAQ v5.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Release_FAQ/CMAQv5.4-Series-FAQ.html">FAQ v5.4</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../Community_Support.html">Community Support</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">CMAQ-ISAM Benchmark Tutorial</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="cmaq-isam-benchmark-tutorial">
<h1>CMAQ-ISAM Benchmark Tutorial<a class="headerlink" href="#cmaq-isam-benchmark-tutorial" title="Link to this heading">#</a></h1>
<p>Procedure to build and run the CMAQ-ISAM model using gnu compiler for the cb6r5_ae7_aq mechanism with the m3dry dry deposition scheme:</p>
<section id="step-1-download-and-run-the-cmaqv5-5-benchmark-case-without-isam-to-confirm-that-your-model-run-is-consistent-with-the-provided-benchmark-output">
<h2>Step 1: Download and run the CMAQv5.5 benchmark case (without ISAM) to confirm that your model run is consistent with the provided benchmark output.<a class="headerlink" href="#step-1-download-and-run-the-cmaqv5-5-benchmark-case-without-isam-to-confirm-that-your-model-run-is-consistent-with-the-provided-benchmark-output" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="CMAQ_UG_tutorial_benchmark.html"><span class="std std-doc">CMAQ Benchmark Tutorial</span></a></p></li>
</ul>
<p>If you encounter any errors, try running the model in debug mode and refer to the CMAS User Forum to determine if any issues have been reported.</p>
<p>https://forum.cmascenter.org/</p>
</section>
<section id="step-2-read-the-user-guide-chapter-on-integrated-source-apportionment-method">
<h2>Step 2: Read the User Guide Chapter on Integrated Source Apportionment Method.<a class="headerlink" href="#step-2-read-the-user-guide-chapter-on-integrated-source-apportionment-method" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../CMAQ_UG_ch11_ISAM.html"><span class="std std-doc">CMAQ User Guide Chapter on ISAM</span></a></p></li>
</ul>
<p>Note: This benchmark is intended to demonstrate how to build and run CMAQ-ISAM with the provided input files</p>
<p>The following isam control file is provided in the CCTM/scripts directory when you obtain the CMAQv5.5 code from github (step 5 below):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="n">isam_control</span><span class="mf">.2018_12</span><span class="n">NE3</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>This file contains the following tag classes</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TAG</span> <span class="n">NAME</span>        <span class="o">|</span><span class="n">EGU</span>
<span class="n">REGION</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>       <span class="o">|</span><span class="n">EVERYWHERE</span>
<span class="n">EMIS</span> <span class="n">STREAM</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>  <span class="o">|</span><span class="n">PT_EGU</span>

<span class="n">TAG</span> <span class="n">NAME</span>        <span class="o">|</span><span class="n">BIO</span>
<span class="n">REGION</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>       <span class="o">|</span><span class="n">NY</span>
<span class="n">EMIS</span> <span class="n">STREAM</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>  <span class="o">|</span><span class="n">BIOG</span>
</pre></div>
</div>
<p>The following gridmask file is provided with the benchmark inputs in the 2018_12NE3_BENCH/2018_12NE3 directory (see step 11 below)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GRIDMASK_STATES_12NE3</span><span class="o">.</span><span class="n">nc</span>
</pre></div>
</div>
<p>Note, all states are listed in the variable list in the header of the file, but the data only contains valid entries for the states in the 12NE3 domain.</p>
<p>The instructions require the user to edit the DESID emissions control namelist file and the DESID chemical control namelist file in the BLD directory. If you want to use emission scaling (independently from ISAM or DDM3D) you will also need to edit these files. (see step 10 below).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>CMAQ_Control_DESID.nml
CMAQ_Control_DESID_${MECH}.nml
</pre></div>
</div>
</section>
<section id="step-3-optional-choose-your-compiler-and-load-it-using-the-module-command-if-it-is-available-on-your-system">
<h2>Step 3 (optional): choose your compiler, and load it using the module command if it is available on your system<a class="headerlink" href="#step-3-optional-choose-your-compiler-and-load-it-using-the-module-command-if-it-is-available-on-your-system" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">avail</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">load</span> <span class="n">openmpi_4</span><span class="mf">.0.1</span><span class="o">/</span><span class="n">gcc_9</span><span class="mf">.1.0</span> 
</pre></div>
</div>
</section>
<section id="step-4-optional-install-i-o-api-note-this-assumes-you-have-already-installed-netcdf-c-and-fortran-libraries">
<h2>Step 4 (optional): Install I/O API (note, this assumes you have already installed netCDF C and Fortran Libraries)<a class="headerlink" href="#step-4-optional-install-i-o-api-note-this-assumes-you-have-already-installed-netcdf-c-and-fortran-libraries" title="Link to this heading">#</a></h2>
<p>I/O APIv3.2 supports up to MXFILE3=256 open files, each with up to MXVARS3=2048. ISAM applications configured to calculate source attribution of a large number of sources may exceed this upper limit of model variables, leading to a model crash. To avoid this issue, users may use I/O API version 3.2 “large” that increases MXFILE3 to 512 and MXVARS3 to 16384. Instructions to build this version are found in Chapter 3. Note, using this ioapi-large version is <b>NOT REQUIRED</b> for the CMAQ-ISAM Benchmark Case. If a user needs to use these larger setting for MXFILE3 and MXVAR3 to support their application, the memory requirements will be increased. If needed, this version is available as a zip file from the following address:</p>
<p>https://www.cmascenter.org/ioapi/download/ioapi-3.2-large-20200828.tar.gz</p>
<p>Otherwise, use the I/O API version available here:
https://www.cmascenter.org/ioapi/download/ioapi-3.2-20200828.tar.gz</p>
</section>
<section id="step-5-install-cmaq-with-isam">
<h2>Step 5: Install CMAQ with ISAM<a class="headerlink" href="#step-5-install-cmaq-with-isam" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="o">-</span><span class="n">b</span> <span class="n">main</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">USEPA</span><span class="o">/</span><span class="n">CMAQ</span><span class="o">.</span><span class="n">git</span> <span class="n">CMAQ_REPO</span>
</pre></div>
</div>
<p>Build and run in a user-specified directory outside of the repository</p>
<p>In the top level of CMAQ_REPO, the bldit_project.csh script will automatically replicate the CMAQ folder structure and copy every build and run script out of the repository so that you may modify them freely without version control.</p>
<p>Edit bldit_project.csh, to modify the variable $CMAQ_HOME to identify the folder that you would like to install the CMAQ package under. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">CMAQ_HOME</span> <span class="o">=</span> <span class="p">[</span><span class="n">your_install_path</span><span class="p">]</span><span class="o">/</span><span class="n">CMAQ_v5</span><span class="mf">.5</span>
</pre></div>
</div>
<p>Now execute the script.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">bldit_project</span><span class="o">.</span><span class="n">csh</span>
</pre></div>
</div>
<p>Change directories to the CMAQ_HOME directory</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="p">[</span><span class="n">your_install_path</span><span class="p">]</span><span class="o">/</span><span class="n">CMAQ_v5</span><span class="mf">.5</span>
</pre></div>
</div>
</section>
<section id="step-6-edit-the-config-cmaq-csh-to-specify-the-paths-of-the-ioapi-and-netcdf-libraries">
<h2>Step 6. Edit the config_cmaq.csh to specify the paths of the ioapi and netCDF libraries<a class="headerlink" href="#step-6-edit-the-config-cmaq-csh-to-specify-the-paths-of-the-ioapi-and-netcdf-libraries" title="Link to this heading">#</a></h2>
</section>
<section id="step-7-modify-the-bldit-cctm-csh-to-activate-isam">
<h2>Step 7: Modify the bldit_cctm.csh to activate ISAM<a class="headerlink" href="#step-7-modify-the-bldit-cctm-csh-to-activate-isam" title="Link to this heading">#</a></h2>
<p>Change directory to CCTM/scripts</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">CCTM</span><span class="o">/</span><span class="n">scripts</span>
<span class="n">cp</span> <span class="n">bldit_cctm</span><span class="o">.</span><span class="n">csh</span> <span class="n">bldit_cctm_isam</span><span class="o">.</span><span class="n">csh</span>
</pre></div>
</div>
<p>Uncomment the following option to compile CCTM with ISAM (remove the # before set ISAM_CCTM):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#&gt; Integrated Source Apportionment Method (ISAM)</span>
<span class="nb">set</span> <span class="n">ISAM_CCTM</span>                         <span class="c1">#&gt; uncomment to compile CCTM with ISAM activated</span>
</pre></div>
</div>
</section>
<section id="step-8-modify-the-bldit-cctm-csh-to-specify-the-cb6r5-ae7-aq-mechanism-and-the-m3dry-dry-deposition-scheme-and-update-the-bld-directory-name">
<h2>Step 8: Modify the bldit_cctm.csh to specify the cb6r5_ae7_aq mechanism and the m3dry dry deposition scheme and update the BLD directory name.<a class="headerlink" href="#step-8-modify-the-bldit-cctm-csh-to-specify-the-cb6r5-ae7-aq-mechanism-and-the-m3dry-dry-deposition-scheme-and-update-the-bld-directory-name" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">DepMod</span>    <span class="o">=</span> <span class="n">m3dry</span>                 <span class="c1">#&gt; dry deposition scheme (m3dry or stage)</span>
<span class="n">setenv</span> <span class="n">Mechanism</span> <span class="n">cb6r5_ae7_aq</span>              <span class="c1">#&gt; chemical mechanism (see $CMAQ_MODEL/CCTM/src/MECHS) </span>
</pre></div>
</div>
<p>Verify that the bldit_cctm_isam.csh script contains the following lines: (the mechanism and the dry deposition scheme have been added to the BLD directory name):</p>
<p>#&gt; Set and create the “BLD” directory for checking out and compiling
#&gt; source code. Move current directory to that build directory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> if ( $?Debug_CCTM ) then
    set Bld = $CMAQ_HOME/CCTM/scripts/BLD_CCTM_${VRSN}_${compilerString}_${Mechanism}_${DepMod}_debug
 else
    set Bld = $CMAQ_HOME/CCTM/scripts/BLD_CCTM_${VRSN}_${compilerString}_${Mechanism}_${DepMod}
 endif
</pre></div>
</div>
</section>
<section id="step-9-run-the-bldit-cctm-isam-csh-script">
<h2>Step 9: Run the bldit_cctm_isam.csh script<a class="headerlink" href="#step-9-run-the-bldit-cctm-isam-csh-script" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">bldit_cctm_isam</span><span class="o">.</span><span class="n">csh</span> <span class="n">gcc</span> <span class="o">|&amp;</span> <span class="n">tee</span> <span class="n">bldit_cctm_isam</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
</section>
<section id="step-10-edit-the-emission-control-namelist-to-recognize-the-cmaq-regions-file">
<h2>Step 10: Edit the Emission Control Namelist to recognize the CMAQ_REGIONS file<a class="headerlink" href="#step-10-edit-the-emission-control-namelist-to-recognize-the-cmaq-regions-file" title="Link to this heading">#</a></h2>
<p>Change directories to the build directory</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">BLD_CCTM_v55_ISAM_gcc_cb6r5_ae7_aq_m3dry</span>
</pre></div>
</div>
<p>edit the DESID emissions namelist file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gedit</span> <span class="n">CMAQ_Control_DESID</span><span class="o">.</span><span class="n">nml</span>
</pre></div>
</div>
<p>Uncomment the line that contains ISAM_REGIONS as the File Label</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&amp;Desid_RegionDef
 Desid_Reg_nml  =
 !            Region Label   | File_Label  | Variable on File
               &#39;EVERYWHERE&#39;  ,&#39;N/A&#39;        ,&#39;N/A&#39;,
 !              &#39;NY&#39;          ,&#39;CMAQ_MASKS&#39;, &#39;NY&#39;,
 !&lt;Example&gt;    &#39;WATER&#39;       ,&#39;CMAQ_MASKS&#39; ,&#39;OPEN&#39;,
 !&lt;Example&gt;    &#39;ALL&#39;         ,&#39;CMAQ_MASKS&#39; ,&#39;ALL&#39;,
               &#39;ALL&#39;         ,&#39;ISAM_REGIONS&#39;,&#39;ALL&#39;,
/
</pre></div>
</div>
</section>
<section id="step-11-example-of-emissions-scaling-reduce-the-pt-egu-emissions-in-ny-by-25-optional-step-described-here-but-not-used">
<h2>Step 11: Example of emissions scaling (Reduce the PT_EGU emissions in NY by 25%) (Optional step, described here, but not used)<a class="headerlink" href="#step-11-example-of-emissions-scaling-reduce-the-pt-egu-emissions-in-ny-by-25-optional-step-described-here-but-not-used" title="Link to this heading">#</a></h2>
<p>edit the DESID chemical control namelist file, note please specify the mechanism or define the MECH environment variable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>gedit CMAQ_Control_DESID_${MECH}.nml
</pre></div>
</div>
<p>Add the following line at the bottom of the the namelist file (before the /)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   ! PT_EGU Emissions Scaling reduce PT_EGU emissions in NY by 25%. Note, to reduce the emissions by 25% we use DESID to multiply what had been 100% emissions by .75, so that the resulting emissions is reduced by 25%.
   &#39;NY&#39;  , &#39;PT_EGU&#39;      ,&#39;All&#39;    ,&#39;All&#39;         ,&#39;All&#39; ,.75    ,&#39;UNIT&#39;,&#39;o&#39;,

</pre></div>
</div>
</section>
<section id="step-12-install-the-cmaq-isam-reference-input-and-output-benchmark-data">
<h2>Step 12: Install the CMAQ-ISAM reference input and output benchmark data<a class="headerlink" href="#step-12-install-the-cmaq-isam-reference-input-and-output-benchmark-data" title="Link to this heading">#</a></h2>
<p>Download the CMAQ two day reference input and output data from the  <a class="reference external" href="https://cmaq-release-benchmark-data-for-easy-download.s3.amazonaws.com/index.html#v5_5/" rel="noreferrer" target="_blank">CMAS Center Data Warehouse Amazon Web Services S3 Bucket <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a>: CMAQv5.4_2018_12NE3_Benchmark_2Day_Input.tar.gz and output_CCTM_v55_ISAM_gcc_Bench_2018_12NE3_cracmm2_stage.tar.gz.</p>
<p>Download and copy the data to <code class="docutils literal notranslate"><span class="pre">$CMAQ_DATA</span></code>. Navigate to the <code class="docutils literal notranslate"><span class="pre">$CMAQ_DATA</span></code> directory, unzip and untar the two day benchmark input and output files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd $CMAQ_DATA
wget https://cmaq-release-benchmark-data-for-easy-download.s3.amazonaws.com/v5_5/CMAQv5.4_2018_12NE3_Benchmark_2Day_Input.tar.gz
tar xvzf CMAQv5.4_2018_12NE3_Benchmark_2Day_Input.tar.gz
mkdir ref_output
cd ref_output
wget https://cmaq-release-benchmark-data-for-easy-download.s3.amazonaws.com/v5_5/output_CCTM_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry.tar.gz
tar xzvf output_CCTM_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry.tar.gz
</pre></div>
</div>
<p>The input files for the CMAQv5.4 ISAM benchmark case are the same as the benchmark inputs for the base model. Output source apportionment files associated with the sample isam_control.txt provided in this release package are included in the benchmark outputs for the base model.</p>
</section>
<section id="step-13-edit-the-cmaq-isam-runscript">
<h2>Step 13: Edit the CMAQ-ISAM runscript<a class="headerlink" href="#step-13-edit-the-cmaq-isam-runscript" title="Link to this heading">#</a></h2>
<p>Note: there is an example of the run script on the AWS S3 bucket.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">CMAQ_v5</span><span class="mf">.5</span><span class="o">/</span><span class="n">CCTM</span><span class="o">/</span><span class="n">scripts</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cmaq</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">benchmark</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">easy</span><span class="o">-</span><span class="n">download</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v5_5</span><span class="o">/</span><span class="n">ISAM_Benchmark</span><span class="o">/</span><span class="n">CCTM</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">run_cctm_Bench_2018_12NE3_cb6r5_m3dry_ISAM</span><span class="o">.</span><span class="n">csh</span>
<span class="n">cat</span> <span class="n">run_cctm_Bench_2018_12NE3_cb6r5_m3dry_ISAM</span><span class="o">.</span><span class="n">csh</span>
</pre></div>
</div>
<p>Verify the following settings in the run script for this ISAM benchmark.</p>
<p>Verify the General Parameters for Configuring the Simulation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> set VRSN = v55_ISAM
 set PROC      = mpi               #&gt; serial or mpi
 set MECH      = cb6r5_ae7_aq      #&gt; Mechanism ID
 set APPL      = Bench_2018_12NE3_${MECH}_m3dry  #&gt; Application Name (e.g. Gridname)
</pre></div>
</div>
<p>Verify the Build directory to include the dry deposition mechanism in the name</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#&gt; Set the build directory (this is where the CMAQ executable
#&gt; is located by default).
 set BLD       = ${CMAQ_HOME}/CCTM/scripts/BLD_CCTM_${VRSN}_${compilerString}_${MECH}_m3dry
</pre></div>
</div>
<p>Verify the input data directory</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#&gt; Set Working, Input, and Output Directories
 setenv WORKDIR ${CMAQ_HOME}/CCTM/scripts          #&gt; Working Directory. Where the runscript is.
 setenv OUTDIR  ${CMAQ_DATA}/output_CCTM_${RUNID}  #&gt; Output Directory
 setenv INPDIR  ${CMAQ_DATA}/CMAQv5.4_2018_12NE3_Benchmark_2Day_Input/2018_12NE3            #&gt; Input Directory
</pre></div>
</div>
<p>Verify the start and end dates to match the input data for this benchmark.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#&gt; Set Start and End Days for looping</span>
 <span class="n">setenv</span> <span class="n">NEW_START</span> <span class="n">TRUE</span>             <span class="c1">#&gt; Set to FALSE for model restart</span>
 <span class="nb">set</span> <span class="n">START_DATE</span> <span class="o">=</span> <span class="s2">&quot;2018-07-01&quot;</span>     <span class="c1">#&gt; beginning date (July 1, 2016)</span>
 <span class="nb">set</span> <span class="n">END_DATE</span>   <span class="o">=</span> <span class="s2">&quot;2018-07-02&quot;</span>     <span class="c1">#&gt; ending date    (July 2, 2016)</span>
</pre></div>
</div>
<p>Verify that ISAM is turned on and that the SA_IOLIST file and ISAM regions file definitions are uncommented.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>setenv CTM_ISAM Y
setenv SA_IOLIST ${WORKDIR}/isam_control.2018_12NE3.txt
setenv ISAM_REGIONS $INPDIR/GRIDMASK_STATES_12NE3.nc
</pre></div>
</div>
<p>Run or Submit the script to the batch queueing system</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">run_cctm_Bench_2018_12NE3_cb6r5_m3dry_ISAM</span><span class="o">.</span><span class="n">csh</span>
</pre></div>
</div>
<p>OR (If using SLRUM) edit the #SBATCH commands at the top of the script for your machine, then run using</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sbatch</span> <span class="n">run_cctm_Bench_2018_12NE3_cb6r5_m3dry_ISAM</span><span class="o">.</span><span class="n">csh</span>
</pre></div>
</div>
</section>
<section id="step-14-verify-that-the-run-was-successful">
<h2>Step 14: Verify that the run was successful<a class="headerlink" href="#step-14-verify-that-the-run-was-successful" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>look for the output directory</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">../../</span><span class="n">data</span><span class="o">/</span><span class="n">output_CCTM_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry</span>
</pre></div>
</div>
<p>If the run was successful you will see the following output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tail</span> <span class="o">./</span><span class="n">LOGS</span><span class="o">/</span><span class="n">CTM_LOG_000</span><span class="o">.</span><span class="n">v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_20180702</span>
</pre></div>
</div>
<p>|&gt;—   PROGRAM COMPLETED SUCCESSFULLY   —&lt;|</p>
</section>
<section id="step-15-compare-output-with-the-2-day-benchmark-outputs-provided-on-the-google-drive">
<h2>Step 15: Compare output with the 2 day benchmark outputs provided on the google drive<a class="headerlink" href="#step-15-compare-output-with-the-2-day-benchmark-outputs-provided-on-the-google-drive" title="Link to this heading">#</a></h2>
<p>The following ISAM output files are generated in addition to the standard CMAQ output files. Note, the ACONC files created for the  benchmark case without ISAM and this run will not be comparible if emission scaling is used (Step 11 - optional), but if emission scaling was not used, the files should be identical.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CCTM_SA_CONC_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_20180702</span><span class="o">.</span><span class="n">nc</span>
<span class="n">CCTM_SA_WETDEP_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_20180702</span><span class="o">.</span><span class="n">nc</span>
<span class="n">CCTM_SA_DRYDEP_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_20180702</span><span class="o">.</span><span class="n">nc</span>
<span class="n">CCTM_SA_ACONC_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_20180702</span><span class="o">.</span><span class="n">nc</span>
<span class="n">CCTM_SA_CGRID_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_20180702</span><span class="o">.</span><span class="n">nc</span>
</pre></div>
</div>
</section>
<section id="step-16-compare-the-tagged-species-in-cctm-sa-aconc-output-file-to-the-species-in-cctm-aconc-output-file">
<h2>Step 16: Compare the tagged species in <code class="docutils literal notranslate"><span class="pre">CCTM_SA_ACONC</span></code> output file to the species in <code class="docutils literal notranslate"><span class="pre">CCTM_ACONC</span></code> output file<a class="headerlink" href="#step-16-compare-the-tagged-species-in-cctm-sa-aconc-output-file-to-the-species-in-cctm-aconc-output-file" title="Link to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ncdump</span> <span class="o">-</span><span class="n">h</span> <span class="n">CCTM_SA_ACONC_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_20180701</span><span class="o">.</span><span class="n">nc</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">SO2_</span>
</pre></div>
</div>
<p>The following tagged species should add up to the total SO2 in the CONC file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>	<span class="nb">float</span> <span class="n">SO2_EGU</span><span class="p">(</span><span class="n">TSTEP</span><span class="p">,</span> <span class="n">LAY</span><span class="p">,</span> <span class="n">ROW</span><span class="p">,</span> <span class="n">COL</span><span class="p">)</span> <span class="p">;</span>
		<span class="n">SO2_EGU</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;SO2_EGU         &quot;</span> <span class="p">;</span>
		<span class="n">SO2_EGU</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;ppmV            &quot;</span> <span class="p">;</span>
		<span class="n">SO2_EGU</span><span class="p">:</span><span class="n">var_desc</span> <span class="o">=</span> <span class="s2">&quot;tracer conc.                                                                    &quot;</span> <span class="p">;</span>
	<span class="nb">float</span> <span class="n">SO2_BIO</span><span class="p">(</span><span class="n">TSTEP</span><span class="p">,</span> <span class="n">LAY</span><span class="p">,</span> <span class="n">ROW</span><span class="p">,</span> <span class="n">COL</span><span class="p">)</span> <span class="p">;</span>
		<span class="n">SO2_BIO</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;SO2_BIO         &quot;</span> <span class="p">;</span>
		<span class="n">SO2_BIO</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;ppmV            &quot;</span> <span class="p">;</span>
		<span class="n">SO2_BIO</span><span class="p">:</span><span class="n">var_desc</span> <span class="o">=</span> <span class="s2">&quot;tracer conc.                                                                    &quot;</span> <span class="p">;</span>
	<span class="nb">float</span> <span class="n">SO2_BCO</span><span class="p">(</span><span class="n">TSTEP</span><span class="p">,</span> <span class="n">LAY</span><span class="p">,</span> <span class="n">ROW</span><span class="p">,</span> <span class="n">COL</span><span class="p">)</span> <span class="p">;</span>
		<span class="n">SO2_BCO</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;SO2_BCO         &quot;</span> <span class="p">;</span>
		<span class="n">SO2_BCO</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;ppmV            &quot;</span> <span class="p">;</span>
		<span class="n">SO2_BCO</span><span class="p">:</span><span class="n">var_desc</span> <span class="o">=</span> <span class="s2">&quot;tracer conc.                                                                    &quot;</span> <span class="p">;</span>
	<span class="nb">float</span> <span class="n">SO2_OTH</span><span class="p">(</span><span class="n">TSTEP</span><span class="p">,</span> <span class="n">LAY</span><span class="p">,</span> <span class="n">ROW</span><span class="p">,</span> <span class="n">COL</span><span class="p">)</span> <span class="p">;</span>
		<span class="n">SO2_OTH</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;SO2_OTH         &quot;</span> <span class="p">;</span>
		<span class="n">SO2_OTH</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;ppmV            &quot;</span> <span class="p">;</span>
		<span class="n">SO2_OTH</span><span class="p">:</span><span class="n">var_desc</span> <span class="o">=</span> <span class="s2">&quot;tracer conc.                                                                    &quot;</span> <span class="p">;</span>
	<span class="nb">float</span> <span class="n">SO2_ICO</span><span class="p">(</span><span class="n">TSTEP</span><span class="p">,</span> <span class="n">LAY</span><span class="p">,</span> <span class="n">ROW</span><span class="p">,</span> <span class="n">COL</span><span class="p">)</span> <span class="p">;</span>
		<span class="n">SO2_ICO</span><span class="p">:</span><span class="n">long_name</span> <span class="o">=</span> <span class="s2">&quot;SO2_ICO         &quot;</span> <span class="p">;</span>
		<span class="n">SO2_ICO</span><span class="p">:</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;ppmV            &quot;</span> <span class="p">;</span>
		<span class="n">SO2_ICO</span><span class="p">:</span><span class="n">var_desc</span> <span class="o">=</span> <span class="s2">&quot;tracer conc.                    </span>
</pre></div>
</div>
<p>The sum of the tagged species in the SA_ACONC file is equal to the species in the ACONC file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SO2_EGU</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">SO2_BIO</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">SO2_BCO</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">SO2_OTH</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">SO2_ICO</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">SO2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">SA_ACONC</span>
<span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">ACONC</span>
</pre></div>
</div>
<p>Both tagged species EGU and BIO contribute to the bulk concentration, therefore the sum of all tagged species including boundary conditions (BCO) and initial conditions (ICO) and other (all untagged emissions) (OTH)</p>
</section>
<section id="step-17-obtain-scripts-and-species-definition-files-to-post-process-cmaq-isam">
<h2>Step 17: Obtain scripts and species definition files to post process CMAQ-ISAM<a class="headerlink" href="#step-17-obtain-scripts-and-species-definition-files-to-post-process-cmaq-isam" title="Link to this heading">#</a></h2>
<p>Note: we will be running each post processing routine twice, once for the tagged species found in the SA_ACONC, SA_DRYDEP, and SA_WETDEP output files, and again for the untagged species found in ACONC and the DRYDEP, WETDEP files. This will allow us to confirm that the sum of the tagged species is equal to the untagged species.</p>
<p>Example species definition file and combine run script are provided to help users post-process the CMAQ-ISAM output to aggregate output from the SA_ACONC, SA_DRYDEP, and SA_WETDEP files.</p>
<p>Download the run script and species definition files for this case from the AWS S3 Bucket.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">CMAQ_v5</span><span class="mf">.5</span><span class="o">/</span><span class="n">POST</span><span class="o">/</span><span class="n">combine</span><span class="o">/</span><span class="n">scripts</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cmaq</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">benchmark</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">easy</span><span class="o">-</span><span class="n">download</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v5_5</span><span class="o">/</span><span class="n">ISAM_Benchmark</span><span class="o">/</span><span class="n">POST</span><span class="o">/</span><span class="n">combine</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">run_combine_ISAM_aconc</span><span class="o">+</span><span class="n">dep_example_cb6r5_ae7_aq_12ne3_benchmark</span><span class="o">.</span><span class="n">csh</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cmaq</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">benchmark</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">easy</span><span class="o">-</span><span class="n">download</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v5_5</span><span class="o">/</span><span class="n">ISAM_Benchmark</span><span class="o">/</span><span class="n">POST</span><span class="o">/</span><span class="n">combine</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">run_combine_ISAM_sa_aconc</span><span class="o">+</span><span class="n">sa_dep_example_cb6r5_ae7_aq_12ne3_benchmark</span><span class="o">.</span><span class="n">csh</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cmaq</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">benchmark</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">easy</span><span class="o">-</span><span class="n">download</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v5_5</span><span class="o">/</span><span class="n">ISAM_Benchmark</span><span class="o">/</span><span class="n">POST</span><span class="o">/</span><span class="n">combine</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">SpecDef_ISAM_Conc_benchmark_cb6r5_ae7_aq</span><span class="o">.</span><span class="n">txt</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cmaq</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">benchmark</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">easy</span><span class="o">-</span><span class="n">download</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v5_5</span><span class="o">/</span><span class="n">ISAM_Benchmark</span><span class="o">/</span><span class="n">POST</span><span class="o">/</span><span class="n">combine</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">SpecDef_ISAM_Dep_benchmark_cb6r5_ae7_aq</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>List the files after they have been downloaded</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="o">-</span><span class="n">lrt</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SpecDef_ISAM_Conc_benchmark_cb6r5_ae7_aq</span><span class="o">.</span><span class="n">txt</span>
<span class="n">SpecDef_ISAM_Dep_benchmark_cb6r5_ae7_aq</span><span class="o">.</span><span class="n">txt</span>
<span class="n">run_combine_ISAM_sa_aconc</span><span class="o">+</span><span class="n">sa_dep_example_cb6r5_ae7_aq_12ne3_benchmark</span><span class="o">.</span><span class="n">csh</span>
<span class="n">run_combine_ISAM_aconc</span><span class="o">+</span><span class="n">dep_example_cb6r5_ae7_aq_12ne3_benchmark</span><span class="o">.</span><span class="n">csh</span>
</pre></div>
</div>
</section>
<section id="step-18-build-and-run-combine">
<h2>Step 18: Build and run combine<a class="headerlink" href="#step-18-build-and-run-combine" title="Link to this heading">#</a></h2>
<p>Build the combine executable</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">CMAQ_v5</span><span class="mf">.5</span><span class="o">/</span><span class="n">POST</span><span class="o">/</span><span class="n">combine</span><span class="o">/</span><span class="n">scripts</span>
<span class="o">./</span><span class="n">bldit_combine</span><span class="o">.</span><span class="n">csh</span> <span class="n">gcc</span> <span class="o">|&amp;</span> <span class="n">tee</span> <span class="o">./</span><span class="n">bldit_combine</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
<p>Run combine to create a file with all hours for the time period of your ISAM simulation for each tagged aggregate species in the SA_ACONC output file and for another file with all hours of the time period in your ISAM simulation for the SA_DRYDEP and SA_WETDEP output files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">run_combine_ISAM_sa_aconc</span><span class="o">+</span><span class="n">sa_dep_example_cb6r5_ae7_aq_12ne3_benchmark</span><span class="o">.</span><span class="n">csh</span> <span class="n">gcc</span> <span class="o">|&amp;</span> <span class="n">tee</span> <span class="o">./</span><span class="n">run_combine_ISAM_sa_aconc</span><span class="o">+</span><span class="n">sa_dep_example_cb6r5_ae7_aq_12ne3_benchmark</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
<p>Run combine to create a file with all hours for the time period of your ISAM simulation for each aggregate species in the ACONC output file and for another file with all hours of the time period in your ISAM simulation for the DRYDEP and WETDEP output files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">run_combine_ISAM_aconc</span><span class="o">+</span><span class="n">dep_example_cb6r5_ae7_aq_12ne3_benchmark</span><span class="o">.</span><span class="n">csh</span> <span class="o">|&amp;</span> <span class="n">tee</span> <span class="o">./</span><span class="n">run_combine_ISAM_aconc</span><span class="o">+</span><span class="n">dep_example_cb6r5_ae7_aq_12ne3_benchmark</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
<p>Examine the output files</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ls</span> <span class="o">-</span><span class="n">lrt</span> <span class="o">../../../</span><span class="n">data</span><span class="o">/</span><span class="n">output_CCTM_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry</span><span class="o">/</span><span class="n">POST</span>
</pre></div>
</div>
<p>You should see that four output files were created:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">lizadams</span> <span class="n">rc_cep</span><span class="o">-</span><span class="n">emc_psx</span> <span class="mi">223856976</span> <span class="n">Sep</span> <span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">32</span> <span class="n">COMBINE_ACONC_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_201807</span><span class="o">.</span><span class="n">nc</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">lizadams</span> <span class="n">rc_cep</span><span class="o">-</span><span class="n">emc_psx</span> <span class="mi">223857340</span> <span class="n">Sep</span> <span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">33</span> <span class="n">COMBINE_DEP_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_201807</span><span class="o">.</span><span class="n">nc</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">lizadams</span> <span class="n">rc_cep</span><span class="o">-</span><span class="n">emc_psx</span> <span class="mi">393254448</span> <span class="n">Sep</span> <span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">33</span> <span class="n">COMBINE_SA_ACONC_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_201807</span><span class="o">.</span><span class="n">nc</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">lizadams</span> <span class="n">rc_cep</span><span class="o">-</span><span class="n">emc_psx</span> <span class="mi">526353656</span> <span class="n">Sep</span> <span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">34</span> <span class="n">COMBINE_SA_DEP_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_201807</span><span class="o">.</span><span class="n">nc</span>
</pre></div>
</div>
</section>
<section id="step-19-review-the-species-definition-files-for-the-isam-run">
<h2>Step 19: Review the species definition files for the ISAM run.<a class="headerlink" href="#step-19-review-the-species-definition-files-for-the-isam-run" title="Link to this heading">#</a></h2>
<p>The species definition file calculates each of the tagged aggregate species. To see each tagged species definition for NOX, where NOX = NO + NO2, use the following grep command:.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grep</span>  <span class="n">NOX_</span> <span class="n">SpecDef_ISAM_Conc_benchmark_cb6r5_ae7_aq</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NOX_EGU</span>             <span class="p">,</span><span class="n">ppbV</span>      <span class="p">,</span><span class="mf">1000.0</span><span class="o">*</span><span class="p">(</span><span class="n">NO_EGU</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">NO2_EGU</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">NOX_BIO</span>             <span class="p">,</span><span class="n">ppbV</span>      <span class="p">,</span><span class="mf">1000.0</span><span class="o">*</span><span class="p">(</span><span class="n">NO_BIO</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">NO2_BIO</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">NOX_BCO</span>             <span class="p">,</span><span class="n">ppbV</span>      <span class="p">,</span><span class="mf">1000.0</span><span class="o">*</span><span class="p">(</span><span class="n">NO_BCO</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">NO2_BCO</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">NOX_ICO</span>             <span class="p">,</span><span class="n">ppbV</span>      <span class="p">,</span><span class="mf">1000.0</span><span class="o">*</span><span class="p">(</span><span class="n">NO_ICO</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">NO2_ICO</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">NOX_OTH</span>             <span class="p">,</span><span class="n">ppbV</span>      <span class="p">,</span><span class="mf">1000.0</span><span class="o">*</span><span class="p">(</span><span class="n">NO_OTH</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">NO2_OTH</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="step-20-build-and-run-calc-tmetric-to-calculate-the-average-of-all-tagged-species-and-the-average-of-all-species-for-your-isam-run">
<h2>Step 20: Build and run calc_tmetric to calculate the average of all tagged species, and the average of all species for your ISAM run.<a class="headerlink" href="#step-20-build-and-run-calc-tmetric-to-calculate-the-average-of-all-tagged-species-and-the-average-of-all-species-for-your-isam-run" title="Link to this heading">#</a></h2>
<p>Build the calc_tmetric executable</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">CMAQ_v5</span><span class="mf">.5</span><span class="o">/</span><span class="n">POST</span><span class="o">/</span><span class="n">calc_tmetric</span><span class="o">/</span><span class="n">scripts</span>
<span class="o">./</span><span class="n">bldit_calc_tmetric</span><span class="o">.</span><span class="n">csh</span> <span class="n">gcc</span> <span class="o">|&amp;</span> <span class="n">tee</span> <span class="o">./</span><span class="n">bldit_calc_tmetric</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
<p>Download the run scripts for calc_tmetric for the ISAM run and copy them to the calc_tmetric/scripts directory..</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">CMAQ_v5</span><span class="mf">.5</span><span class="o">/</span><span class="n">POST</span><span class="o">/</span><span class="n">calc_tmetric</span><span class="o">/</span><span class="n">scripts</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cmaq</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">benchmark</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">easy</span><span class="o">-</span><span class="n">download</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v5_5</span><span class="o">/</span><span class="n">ISAM_Benchmark</span><span class="o">/</span><span class="n">POST</span><span class="o">/</span><span class="n">calc_tmetric</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">run_calc_tmetric_ISAM_aconc</span><span class="o">.</span><span class="n">csh</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cmaq</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">benchmark</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">easy</span><span class="o">-</span><span class="n">download</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v5_5</span><span class="o">/</span><span class="n">ISAM_Benchmark</span><span class="o">/</span><span class="n">POST</span><span class="o">/</span><span class="n">calc_tmetric</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">run_calc_tmetric_ISAM_sa_aconc</span><span class="o">.</span><span class="n">csh</span>
</pre></div>
</div>
<p>Run the calc_tmetric scripts</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">run_calc_tmetric_ISAM_sa_aconc</span><span class="o">.</span><span class="n">csh</span> <span class="n">gcc</span> <span class="o">|&amp;</span> <span class="n">tee</span> <span class="o">./</span><span class="n">run_calc_tmetric_ISAM_sa_aconc</span><span class="o">.</span><span class="n">log</span>
<span class="o">./</span><span class="n">run_calc_tmetric_ISAM_aconc</span><span class="o">.</span><span class="n">csh</span> <span class="n">gcc</span> <span class="o">|&amp;</span> <span class="n">tee</span> <span class="o">./</span><span class="n">run_calc_tmetric_ISAM_aconc</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
</section>
<section id="step-21-build-and-run-hr2day-to-calculate-the-daily-average-concentration-for-each-tagged-and-aggregated-species">
<h2>Step 21: Build and run hr2day to calculate the daily average concentration for each tagged and aggregated species.<a class="headerlink" href="#step-21-build-and-run-hr2day-to-calculate-the-daily-average-concentration-for-each-tagged-and-aggregated-species" title="Link to this heading">#</a></h2>
<p>Build the hr2day executable</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">CMAQ_v5</span><span class="mf">.5</span><span class="o">/</span><span class="n">POST</span><span class="o">/</span><span class="n">hr2day</span><span class="o">/</span><span class="n">scripts</span>
<span class="o">./</span><span class="n">bldit_hr2day</span><span class="o">.</span><span class="n">csh</span> <span class="n">gcc</span> <span class="o">|&amp;</span> <span class="n">tee</span> <span class="o">./</span><span class="n">bldit_hr2day</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
<p>Download the run scripts for hr2day for the ISAM run</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span>  <span class="n">CMAQ_v5</span><span class="mf">.5</span><span class="o">/</span><span class="n">POST</span><span class="o">/</span><span class="n">hr2day</span><span class="o">/</span><span class="n">scripts</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cmaq</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">benchmark</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">easy</span><span class="o">-</span><span class="n">download</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v5_5</span><span class="o">/</span><span class="n">ISAM_Benchmark</span><span class="o">/</span><span class="n">POST</span><span class="o">/</span><span class="n">hr2day</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">run_hr2day_ISAM_aconc</span><span class="o">.</span><span class="n">csh</span>
<span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">cmaq</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">benchmark</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">easy</span><span class="o">-</span><span class="n">download</span><span class="o">.</span><span class="n">s3</span><span class="o">.</span><span class="n">amazonaws</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">v5_5</span><span class="o">/</span><span class="n">ISAM_Benchmark</span><span class="o">/</span><span class="n">POST</span><span class="o">/</span><span class="n">hr2day</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">run_hr2day_ISAM_sa_aconc</span><span class="o">.</span><span class="n">csh</span>
</pre></div>
</div>
<p>Run hr2day for both the SA_ACONC and ACONC file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">run_hr2day_ISAM_sa_aconc</span><span class="o">.</span><span class="n">csh</span> <span class="n">gcc</span> <span class="o">|&amp;</span> <span class="n">tee</span> <span class="o">./</span><span class="n">run_hr2day_ISAM_sa_aconc</span><span class="o">.</span><span class="n">log</span>
<span class="o">./</span><span class="n">run_hr2day_ISAM_aconc</span><span class="o">.</span><span class="n">csh</span> <span class="n">gcc</span> <span class="o">|&amp;</span> <span class="n">tee</span> <span class="o">./</span><span class="n">run_hr2day_ISAM_aconc</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
<p>Note, there are HR2DAY configuration options that were modified from the default settings, as this ISAM benchmark contains only two days of output, so it does not make sense to use the option to change from GMT time to local time, which is typically done to compare to observational data.</p>
<p>The output data is set to be saved under the ISAM output directory.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">CMAQ_v5</span><span class="mf">.5</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">output_CCTM_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry</span><span class="o">/</span><span class="n">POST</span>
<span class="n">ls</span> <span class="o">-</span><span class="n">lrt</span>
</pre></div>
</div>
<p>List of POST Output files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">lizadams</span> <span class="n">rc_cep</span><span class="o">-</span><span class="n">emc_psx</span> <span class="mi">223856976</span> <span class="n">Sep</span> <span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">32</span> <span class="n">COMBINE_ACONC_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_201807</span><span class="o">.</span><span class="n">nc</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">lizadams</span> <span class="n">rc_cep</span><span class="o">-</span><span class="n">emc_psx</span> <span class="mi">223857340</span> <span class="n">Sep</span> <span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">33</span> <span class="n">COMBINE_DEP_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_201807</span><span class="o">.</span><span class="n">nc</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">lizadams</span> <span class="n">rc_cep</span><span class="o">-</span><span class="n">emc_psx</span> <span class="mi">393254448</span> <span class="n">Sep</span> <span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">33</span> <span class="n">COMBINE_SA_ACONC_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_201807</span><span class="o">.</span><span class="n">nc</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">lizadams</span> <span class="n">rc_cep</span><span class="o">-</span><span class="n">emc_psx</span> <span class="mi">526353656</span> <span class="n">Sep</span> <span class="mi">26</span> <span class="mi">15</span><span class="p">:</span><span class="mi">34</span> <span class="n">COMBINE_SA_DEP_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_201807</span><span class="o">.</span><span class="n">nc</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">lizadams</span> <span class="n">rc_cep</span><span class="o">-</span><span class="n">emc_psx</span>   <span class="mi">8251888</span> <span class="n">Sep</span> <span class="mi">27</span> <span class="mi">14</span><span class="p">:</span><span class="mi">07</span> <span class="n">AVG_COMBINE_SA_ACONC_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry</span><span class="o">.</span><span class="n">nc</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">lizadams</span> <span class="n">rc_cep</span><span class="o">-</span><span class="n">emc_psx</span>    <span class="mi">432268</span> <span class="n">Sep</span> <span class="mi">27</span> <span class="mi">14</span><span class="p">:</span><span class="mi">13</span> <span class="n">dailyavg_SA_ACONC_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_201807</span><span class="o">.</span><span class="n">nc</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">lizadams</span> <span class="n">rc_cep</span><span class="o">-</span><span class="n">emc_psx</span>     <span class="mi">95208</span> <span class="n">Sep</span> <span class="mi">27</span> <span class="mi">14</span><span class="p">:</span><span class="mi">14</span> <span class="n">dailyavg_ACONC_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry</span><span class="o">.</span><span class="n">nc</span>
</pre></div>
</div>
<p>VERDI can be used to compare the aggregated species in ACONC to the sum of the tagged aggregated species in the SA_ACONC file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cd CMAQ_v5.5/data/output_CCTM_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry/POST
verdi -f $cwd/COMBINE_ACONC_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_201807.nc -f $cwd/COMBINE_SA_ACONC_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_201807.nc -s &quot;NOX[1]&quot; -g tile -s &quot;NOX_EGU[2]+NOX_BIO[2]+NOX_BCO[2]+NOX_ICO[2]+NOX_OTH[2]&quot; -g tile 
</pre></div>
</div>
<p>Note, the min and max of the two tile plots should be identical. The difference can also be calculated to verify that they are only different by numerical roundoff.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>verdi -f $cwd/COMBINE_ACONC_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_201807.nc -f $cwd/COMBINE_SA_ACONC_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_201807.nc -s &quot;NOX[1] - (NOX_EGU[2]+NOX_BIO[2]+NOX_BCO[2]+NOX_ICO[2]+NOX_OTH[2])&quot; -g tile
</pre></div>
</div>
<p>VERDI can also be used to confirm that the average concentration of the aggregated species is equal to the sum of the tagged aggregated species, please note that this average is taken over two days, as the ISAM benchmark ran for two days, and two days were available in the combine output file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>verdi -f $cwd/AVG_COMBINE_ACONC_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry.nc -f $cwd/AVG_COMBINE_SA_ACONC_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry.nc -s &quot;NOX[1]&quot; -g tile -s &quot;NOX_EGU_AVG[2]+NOX_BIO_AVG[2]+NOX_BCO_AVG[2]+NOX_ICO_AVG[2]+NOX_OTH_AVG[2]&quot; -g tile
</pre></div>
</div>
<p>VERDI can also be used to confirm that the daily average concentration of the aggregated species is equal to the sum of the tagged aggregated species. Note, that there are two timesteps in each daily average file, one containing the average for day 1 and one containing the average for day 2</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>verdi -f $cwd/dailyavg_ACONC_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_201807.nc -f $cwd/dailyavg_SA_ACONC_v55_ISAM_gcc_Bench_2018_12NE3_cb6r5_ae7_aq_m3dry_201807.nc -s &quot;NOX[1]&quot; -g tile -s &quot;NOX_EGU[2]+NOX_BIO[2]+NOX_BCO[2]+NOX_ICO[2]+NOX_OTH[2]&quot; -g tile  
</pre></div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-download-and-run-the-cmaqv5-5-benchmark-case-without-isam-to-confirm-that-your-model-run-is-consistent-with-the-provided-benchmark-output">Step 1: Download and run the CMAQv5.5 benchmark case (without ISAM) to confirm that your model run is consistent with the provided benchmark output.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-read-the-user-guide-chapter-on-integrated-source-apportionment-method">Step 2: Read the User Guide Chapter on Integrated Source Apportionment Method.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-optional-choose-your-compiler-and-load-it-using-the-module-command-if-it-is-available-on-your-system">Step 3 (optional): choose your compiler, and load it using the module command if it is available on your system</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-4-optional-install-i-o-api-note-this-assumes-you-have-already-installed-netcdf-c-and-fortran-libraries">Step 4 (optional): Install I/O API (note, this assumes you have already installed netCDF C and Fortran Libraries)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-5-install-cmaq-with-isam">Step 5: Install CMAQ with ISAM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-6-edit-the-config-cmaq-csh-to-specify-the-paths-of-the-ioapi-and-netcdf-libraries">Step 6. Edit the config_cmaq.csh to specify the paths of the ioapi and netCDF libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-7-modify-the-bldit-cctm-csh-to-activate-isam">Step 7: Modify the bldit_cctm.csh to activate ISAM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-8-modify-the-bldit-cctm-csh-to-specify-the-cb6r5-ae7-aq-mechanism-and-the-m3dry-dry-deposition-scheme-and-update-the-bld-directory-name">Step 8: Modify the bldit_cctm.csh to specify the cb6r5_ae7_aq mechanism and the m3dry dry deposition scheme and update the BLD directory name.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-9-run-the-bldit-cctm-isam-csh-script">Step 9: Run the bldit_cctm_isam.csh script</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-10-edit-the-emission-control-namelist-to-recognize-the-cmaq-regions-file">Step 10: Edit the Emission Control Namelist to recognize the CMAQ_REGIONS file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-11-example-of-emissions-scaling-reduce-the-pt-egu-emissions-in-ny-by-25-optional-step-described-here-but-not-used">Step 11: Example of emissions scaling (Reduce the PT_EGU emissions in NY by 25%) (Optional step, described here, but not used)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-12-install-the-cmaq-isam-reference-input-and-output-benchmark-data">Step 12: Install the CMAQ-ISAM reference input and output benchmark data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-13-edit-the-cmaq-isam-runscript">Step 13: Edit the CMAQ-ISAM runscript</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-14-verify-that-the-run-was-successful">Step 14: Verify that the run was successful</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-15-compare-output-with-the-2-day-benchmark-outputs-provided-on-the-google-drive">Step 15: Compare output with the 2 day benchmark outputs provided on the google drive</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-16-compare-the-tagged-species-in-cctm-sa-aconc-output-file-to-the-species-in-cctm-aconc-output-file">Step 16: Compare the tagged species in <code class="docutils literal notranslate"><span class="pre">CCTM_SA_ACONC</span></code> output file to the species in <code class="docutils literal notranslate"><span class="pre">CCTM_ACONC</span></code> output file</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-17-obtain-scripts-and-species-definition-files-to-post-process-cmaq-isam">Step 17: Obtain scripts and species definition files to post process CMAQ-ISAM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-18-build-and-run-combine">Step 18: Build and run combine</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-19-review-the-species-definition-files-for-the-isam-run">Step 19: Review the species definition files for the ISAM run.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-20-build-and-run-calc-tmetric-to-calculate-the-average-of-all-tagged-species-and-the-average-of-all-species-for-your-isam-run">Step 20: Build and run calc_tmetric to calculate the average of all tagged species, and the average of all species for your ISAM run.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-21-build-and-run-hr2day-to-calculate-the-daily-average-concentration-for-each-tagged-and-aggregated-species">Step 21: Build and run hr2day to calculate the daily average concentration for each tagged and aggregated species.</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>