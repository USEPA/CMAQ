
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="../../_static/CMAQ_Logo_2_inch.png" sizes="600x593" rel="icon" type="image/png">
    <title>11. Integrated Source Apportionment Method (CMAQ-ISAM) &#8212; CMAQ 5.5+ documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=eec9c716"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'DOCS/Users_Guide/CMAQ_UG_ch11_ISAM';</script>
    <link rel="canonical" href="https://usepa.github.io/CMAQ/DOCS/Users_Guide/CMAQ_UG_ch11_ISAM.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="12. Sulfur Tracking Method" href="CMAQ_UG_ch12_sulfur_tracking.html" />
    <link rel="prev" title="10. Decoupled Direct Method in Three Dimensions (CMAQ-DDM-3D)" href="CMAQ_UG_ch10_HDDM-3D.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/CMAQ_Logo_2_inch.png" class="logo__image only-light" alt="CMAQ 5.5+ documentation - Home"/>
    <img src="../../_static/CMAQ_Logo_2_inch.png" class="logo__image only-dark pst-js-only" alt="CMAQ 5.5+ documentation - Home"/>
  
  
</a></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/USEPA/CMAQ" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.epa.gov/cmaq" title="CMAQ - EPA Site" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../_static/epa_seal_w-ring_RGB-sm.png" class="icon-link-image" alt="CMAQ - EPA Site"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://forum.cmascenter.org/" title="User Forum" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../_static/cmas_logo.png" class="icon-link-image" alt="User Forum"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://usepa.github.io/CRACMM/" title="CRACMM" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../_static/CRACMM_1.png" class="icon-link-image" alt="CRACMM"/></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/CMAQ_Logo_2_inch.png" class="logo__image only-light" alt="CMAQ 5.5+ documentation - Home"/>
    <img src="../../_static/CMAQ_Logo_2_inch.png" class="logo__image only-dark pst-js-only" alt="CMAQ 5.5+ documentation - Home"/>
  
  
</a></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/USEPA/CMAQ" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.epa.gov/cmaq" title="CMAQ - EPA Site" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../_static/epa_seal_w-ring_RGB-sm.png" class="icon-link-image" alt="CMAQ - EPA Site"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://forum.cmascenter.org/" title="User Forum" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../_static/cmas_logo.png" class="icon-link-image" alt="User Forum"/></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://usepa.github.io/CRACMM/" title="CRACMM" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><img src="../../_static/CRACMM_1.png" class="icon-link-image" alt="CRACMM"/></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Getting_Started.html">Getting Started</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="README.html">CMAQ User’s Guide</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="CMAQ_UG_ch01_overview.html">1. Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="CMAQ_UG_ch02_program_structure.html">2. Program Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="CMAQ_UG_ch03_preparing_compute_environment.html">3. Preparing Compute Environment for CMAQ Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="CMAQ_UG_ch04_model_inputs.html">4. Model Input Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="CMAQ_UG_ch05_running_a_simulation.html">5. Running a CMAQ Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="CMAQ_UG_ch06_model_configuration_options.html">6. Model Configuration Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="CMAQ_UG_ch07_model_outputs.html">7. Model Output Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="CMAQ_UG_ch08_analysis_tools.html">8. Analysis Tools for CMAQ output</a></li>
<li class="toctree-l2"><a class="reference internal" href="CMAQ_UG_ch09_process_analysis.html">9. Process Analysis and Budget</a></li>
<li class="toctree-l2"><a class="reference internal" href="CMAQ_UG_ch10_HDDM-3D.html">10. Decoupled Direct Method in Three Dimensions (CMAQ-DDM-3D)</a></li>




<li class="toctree-l2 current active"><a class="current reference internal" href="#">11. Integrated Source Apportionment Method (CMAQ-ISAM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="CMAQ_UG_ch12_sulfur_tracking.html">12. Sulfur Tracking Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="CMAQ_UG_ch13_WRF-CMAQ.html">13. WRF-CMAQ Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="CMAQ_UG_ch14_MPAS-CMAQ.html">14. MPAS-CMAQ Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="Appendix/README.html">Appendix</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Tutorials/README.html">CMAQ Tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="Tutorials/CMAQ_UG_tutorial_configure_linux_environment.html">Configuring your compute environment for CMAQ simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="Tutorials/CMAQ_UG_tutorial_running_benchmarks.html">CMAQ Benchmark Tutorials</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Release_Notes/README.html">Release Notes</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Release_Notes/CMAQ-Release-Notes%3A-Instrumented-Models.html">Instrumented Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Release_Notes/CMAQ-Release-Notes%3A-MPAS-CMAQ-Coupled-Model.html">MPAS-CMAQ Coupled Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Release_Notes/CMAQ-Release-Notes%3A-WRF-CMAQ-Coupled-Model.html">WRF-CMAQ Coupled Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Release_Notes/CMAQ-Release-Notes%3A-Chemistry.html">Chemistry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Release_Notes/CMAQ-Release-Notes%3A-Transport-Processes.html">Transport Processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Release_Notes/CMAQ-Release-Notes%3A-Dry-Deposition-Air-Surface-Exchange.html">Dry Deposition/Air-Surface Exchange</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Release_Notes/CMAQ-Release-Notes%3A-Emissions-Updates.html">Emissions Updates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Release_Notes/CMAQ-Release-Notes%3A-Process-Analysis-%26-Sulfur-Tracking-Model-%28STM%29.html">Process Analysis &amp; STM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Release_Notes/CMAQ-Release-Notes%3A-Structural-Improvements.html">Structural Improvements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Release_Notes/CMAQ-Release-Notes%3A-Diagnostic-Options.html">Diagnostic Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Release_Notes/CMAQ-Release-Notes%3A-Preprocessors.html">Pre-processors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Release_Notes/CMAQ-Release-Notes%3A-PYTOOLS.html">PYTOOLS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Release_Notes/CMAQ-Release-Notes%3A-Postprocessors.html">Post-processors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Release_Notes/CMAQ-Release-Notes%3A-Utilities.html">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Release_Notes/CMAQ-Release-Notes%3A-Stratospheric%E2%80%90Tropospheric-Exchange-%28STE%29.html">Stratospheric-Tropospheric Exchange (STE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CMAQ-Bugfix-Branch.html">Bug fix branch</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Release_FAQ/README.html">FAQs</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Release_FAQ/CMAQv5.5-Series-FAQ.html">FAQ v5.5</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Release_FAQ/CMAQv5.4-Series-FAQ.html">FAQ v5.4</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../Community_Support.html">Community Support</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="README.html" class="nav-link">CMAQ User’s Guide</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">11. Integrated Source Apportionment Method (CMAQ-ISAM)</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <!-- BEGIN COMMENT -->
<p><a class="reference internal" href="CMAQ_UG_ch10_HDDM-3D.html"><span class="std std-doc">&lt;&lt; Previous Chapter</span></a> - <a class="reference internal" href="README.html"><span class="std std-doc">Home</span></a> - <a class="reference internal" href="CMAQ_UG_ch12_sulfur_tracking.html"><span class="std std-doc">Next Chapter &gt;&gt;</span></a></p>
<!-- END COMMENT -->
<section id="integrated-source-apportionment-method-cmaq-isam">
<h1>11. Integrated Source Apportionment Method (CMAQ-ISAM)<a class="headerlink" href="#integrated-source-apportionment-method-cmaq-isam" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>11.1 Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>The Integrated Source Apportionment Method (ISAM) calculates source attribution information for user specified ozone and particulate matter precursors within the CMAQ model.  CMAQ-ISAM has been substantially updated starting with the CMAQv5.3 release, and now differs significantly from previous releases. The major changes to the ISAM chemistry solver are detailed in the <a class="reference external" href="https://github.com/USEPA/CMAQ/blob/main/DOCS/Users_Guide/Supplement/CMAQ_ISAM_Chemistry_Supplemental_Equations.pdf" rel="noreferrer" target="_blank">ISAM Chemistry Supplement <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a>. In addition, signifcant updates and multiple minor fixes were included in the  subsequent releases including substantial updates to the gas-phase chemistry apportionment algorithms that improve both physical and numerical aspects of the method. Users of CMAQ-ISAM are strongly encouraged to update to the latest available release of the model.</p>
<p>The base CMAQ model provides users the concentration and deposition fields of many pollutant species. These species are usually combinations of different types of primary emissions and secondary formation that have been physically and chemically transformed in the model. However, sometimes it is desirable to know specific source attribution information for the model outputs. For example, how much of the ozone in an urban area was formed due to nitrogen oxides emitted from motor vehicles in a neighboring state?</p>
<p>Answering this type of question often requires running an air quality model twice, once with the standard emissions scenario and once with the source of interest completely removed. The difference between the two runs is then assumed to be attributed to the removed source.  While this approach is reasonably straightforward to implement, it has some drawbacks.  For example, removing a large source from the system in a highly nonlinear chemical mixture can lead to some errors. Also, calculating source attribution of many sources can be logistically and computationally prohibitive.</p>
<p>Alternatively, running CMAQ with ISAM enabled allows the user the ability to calculate source attribution of a large number of sources directly by the model in one simulation.</p>
<p>CMAQ-ISAM supports source apportionment for all modeled gas and aerosol species (depending on base model configuration). The selection of species for which source apportionment should be performed in a given simulation can be controlled through the following <code class="docutils literal notranslate"><span class="pre">TAG</span> <span class="pre">CLASSES</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SULFATE</span>      <span class="o">-</span> <span class="n">ASO4J</span><span class="p">,</span> <span class="n">ASO4I</span><span class="p">,</span> <span class="n">SO2</span><span class="p">,</span> <span class="n">SULF</span><span class="p">,</span> <span class="n">SULRXN</span>       
<span class="n">NITRATE</span>      <span class="o">-</span> <span class="n">ANO3J</span><span class="p">,</span> <span class="n">ANO3I</span><span class="p">,</span> <span class="n">HNO3</span><span class="p">,</span> <span class="n">ANO3J</span><span class="p">,</span> <span class="n">ANO3I</span><span class="p">,</span> <span class="n">HNO3</span><span class="p">,</span> <span class="n">NO</span><span class="p">,</span> <span class="n">NO2</span><span class="p">,</span> <span class="n">NO3</span><span class="p">,</span> <span class="n">HONO</span><span class="p">,</span> <span class="n">N2O5</span><span class="p">,</span> <span class="n">PNA</span><span class="p">,</span> <span class="n">PAN</span><span class="p">,</span> <span class="n">PANX</span><span class="p">,</span> <span class="n">NTR1</span><span class="p">,</span> <span class="n">NTR2</span><span class="p">,</span> <span class="n">INTR</span>           
<span class="n">AMMONIUM</span>     <span class="o">-</span> <span class="n">ANH4J</span><span class="p">,</span> <span class="n">ANH4I</span><span class="p">,</span> <span class="n">NH3</span>       
<span class="n">EC</span>           <span class="o">-</span> <span class="n">AECJ</span><span class="p">,</span> <span class="n">AECI</span>          
<span class="n">OA_TOT</span>       <span class="o">-</span> <span class="n">Organic</span> <span class="n">aerosol</span> <span class="n">species</span>
<span class="n">VOC</span>          <span class="o">-</span> <span class="n">Various</span> <span class="n">species</span> <span class="n">depending</span> <span class="n">on</span> <span class="n">mechanism</span><span class="o">.</span> <span class="n">Now</span> <span class="n">includes</span> <span class="n">CO</span><span class="o">.</span> <span class="p">(</span><span class="n">see</span> <span class="n">CCTM</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">isam</span><span class="o">/</span><span class="n">SA_DEFN</span><span class="o">.</span><span class="n">F</span> <span class="k">for</span> <span class="n">complete</span> <span class="nb">list</span><span class="p">)</span>      
<span class="n">PM_IONS</span>      <span class="o">-</span> <span class="n">ANAI</span><span class="p">,</span> <span class="n">ANAJ</span><span class="p">,</span> <span class="n">AMGJ</span><span class="p">,</span> <span class="n">AKJ</span><span class="p">,</span> <span class="n">ACAJ</span><span class="p">,</span> <span class="n">AFEJ</span><span class="p">,</span> <span class="n">AALJ</span><span class="p">,</span> <span class="n">ASIJ</span><span class="p">,</span> <span class="n">ATIJ</span><span class="p">,</span> <span class="n">AMNJ</span><span class="p">,</span> <span class="n">AOTHRI</span><span class="p">,</span> <span class="n">AOTHRJ</span>      
<span class="n">OZONE</span>        <span class="o">-</span> <span class="nb">all</span> <span class="n">NITRATE</span> <span class="n">species</span> <span class="o">+</span> <span class="nb">all</span> <span class="n">VOC</span> <span class="n">species</span>     
<span class="n">CHLORINE</span>     <span class="o">-</span> <span class="n">ACLI</span><span class="p">,</span> <span class="n">ACLJ</span><span class="p">,</span> <span class="n">HCL</span>
<span class="n">NVPOA</span>        <span class="o">-</span> <span class="n">Non</span><span class="o">-</span><span class="n">Volatile</span> <span class="n">Primary</span> <span class="n">Organic</span> <span class="n">Aerosol</span> <span class="p">(</span><span class="n">APOC</span><span class="p">,</span> <span class="n">APNCOM</span><span class="p">)</span>
<span class="n">PM_TOT</span>       <span class="o">-</span> <span class="nb">all</span> <span class="n">PM</span> <span class="n">species</span>
<span class="n">HAP_GAS</span>      <span class="o">-</span> <span class="n">Gaseous</span> <span class="n">Hazardous</span> <span class="n">Air</span> <span class="n">Pollutants</span>
<span class="n">HAP_AERO</span>     <span class="o">-</span> <span class="n">Aerosol</span> <span class="n">Hazardous</span> <span class="n">Air</span> <span class="n">Pollutants</span>
<span class="n">HAP_TOT</span>      <span class="o">-</span> <span class="n">HAP_GAS</span> <span class="ow">and</span> <span class="n">HAP_AERO</span>
<span class="n">URBAN_TOXICS</span> <span class="o">-</span> <span class="n">Classic</span> <span class="n">Urban</span> <span class="n">Air</span> <span class="n">Toxics</span> 
<span class="n">PAH_TEQ</span>      <span class="o">-</span> <span class="n">NonReactive</span> <span class="n">PAH</span> <span class="n">tracers</span>
<span class="n">BENAPYRENE</span>   <span class="o">-</span> <span class="n">Gaseous</span> <span class="ow">and</span> <span class="n">aerosol</span> <span class="n">Benzo</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="n">Pyrene</span>
<span class="n">MERCURY</span>      <span class="o">-</span> <span class="n">Gaseous</span> <span class="ow">and</span> <span class="n">aeroosl</span> <span class="n">Mercury</span> <span class="n">species</span>
<span class="n">ALL</span>          <span class="o">-</span> <span class="n">All</span> <span class="n">model</span> <span class="n">species</span>

    
</pre></div>
</div>
</section>
<section id="build-instructions">
<h2>11.2 Build Instructions<a class="headerlink" href="#build-instructions" title="Link to this heading">#</a></h2>
<p>Starting with CMAQv5.3 model release, ISAM is provided directly with the source code of the base model. To use ISAM, follow the normal build process for CMAQ described in <a class="reference internal" href="CMAQ_UG_ch05_running_a_simulation.html"><span class="std std-doc">Chapter 5</span></a>, but make sure to uncomment the following line in bldit_cctm.csh:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">ISAM_CCTM</span>
</pre></div>
</div>
<p><strong>A note about I/O API installation for ISAM applications</strong></p>
<p>I/O APIv3.2  supports up to MXFILE3=256 open files, each with up to MXVARS3=2048. ISAM applications configured to calculate source attribution of a large number of sources may exceed this upper limit of model variables, leading to a model crash. To avoid this issue, users may use I/O API version 3.2 “large” that increases MXFILE3 to 512 and MXVARS3 to 16384. Instructions to build this version are found in <a class="reference internal" href="CMAQ_UG_ch03_preparing_compute_environment.html#333-io-api-library"><span class="std std-ref">Chapter 3</span></a>.
Note, using this ioapi-large version is not required for the CMAQ-ISAM Benchmark Case.
If a user needs to use larger setting for MXFILE3 and MXVAR3 to support their application, note that the memory requirements will be increased.
This version is available as a zip file from the following address:</p>
<p>https://www.cmascenter.org/ioapi/download/ioapi-3.2-large-20200828.tar.gz</p>
<p><strong>A note about solver configuration</strong></p>
<p>ISAM is currently only implemented for the EBI solver. For some CMAQ applications, the Rosenbrock solver is desirable and is set as the default in the sample runscripts. For example, this is the case when using the CB6R5M chemical mechanism for hemispheric simulations. In such cases, the bldit script needs to be modified to not select the Rosenbrock solver. While this may incur a performance penalty in terms of CPU time and increase the likelyhood of convergence warnings, it will allow the ISAM simulation to proceed in most cases.</p>
</section>
<section id="run-instructions">
<h2>11.3 Run Instructions<a class="headerlink" href="#run-instructions" title="Link to this heading">#</a></h2>
<p>To begin a CMAQ simulation with source apportionment enabled, the ISAM section of the runscript must be configured.  The additional necessary environment variables are listed in Table 11-1.</p>
<p><a id=Table11-1></a></p>
<p><strong>Table 11-1. ISAM run script variables</strong></p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Variable</strong></p></th>
<th class="head"><p><strong>Settings</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CTM_ISAM</p></td>
<td><p>Y/N</p></td>
<td><p>Set this to Y to enable ISAM</p></td>
</tr>
<tr class="row-odd"><td><p>SA_IOLIST</p></td>
<td><p>path/filename</p></td>
<td><p>Provide the location of the ISAM control file (discussed below)</p></td>
</tr>
<tr class="row-even"><td><p>ISAM_BLEV_ELEV</p></td>
<td><p>“ MINVALUE MAX VALUE “</p></td>
<td><p>LAYER range for the instantaneous ISAM output concentrations</p></td>
</tr>
<tr class="row-odd"><td><p>AISAM_BLEV_ELEV</p></td>
<td><p>“ MINVALUE MAX VALUE “</p></td>
<td><p>LAYER range for the average ISAM output concentrations</p></td>
</tr>
<tr class="row-even"><td><p>ISAM_NEW_START</p></td>
<td><p>Y/N</p></td>
<td><p>set Y for a new simulation and N for continuing from a previous day’s outputs</p></td>
</tr>
<tr class="row-odd"><td><p>ISAM_PREVDAY</p></td>
<td><p>path/filename</p></td>
<td><p>Provide the location of the previous day’s ISAM restart file</p></td>
</tr>
<tr class="row-even"><td><p>SA_ACONC_1</p></td>
<td><p>path/filename</p></td>
<td><p>ISAM output for average apportioned concentrations</p></td>
</tr>
<tr class="row-odd"><td><p>SA_CONC_1</p></td>
<td><p>path/filename</p></td>
<td><p>ISAM output for instanteneous apportioned concentrations</p></td>
</tr>
<tr class="row-even"><td><p>SA_DD_1</p></td>
<td><p>path/filename</p></td>
<td><p>ISAM output for apportioned dry deposition</p></td>
</tr>
<tr class="row-odd"><td><p>SA_WD_1</p></td>
<td><p>path/filename</p></td>
<td><p>ISAM output for apportioned wet deposition</p></td>
</tr>
<tr class="row-even"><td><p>SA_CGRID_1</p></td>
<td><p>path/filename</p></td>
<td><p>ISAM output for a restart file to continue the simulation further in time</p></td>
</tr>
<tr class="row-odd"><td><p>ISAM_O3_WEIGHTS</p></td>
<td><p>1,2,3,4,5 (default is 5)</p></td>
<td><p>sets what tracked species are favored or <em>weighted</em> when determining apportionment in gas phase chemistry</p></td>
</tr>
<tr class="row-even"><td><p>ISAM_NOX_CASE</p></td>
<td><p>1,2,3,4 (default is 2)</p></td>
<td><p>what tracked species are weighted when grid cell NOx limited ozone production. Only used if ISAM_O3_WEIGHT equal 5.</p></td>
</tr>
<tr class="row-odd"><td><p>ISAM_VOC_CASE</p></td>
<td><p>1,2,3,4 (default is 4)</p></td>
<td><p>what tracked species are weighted when grid cell VOC limited ozone production. Only used if ISAM_O3_WEIGHT equal 5.</p></td>
</tr>
<tr class="row-even"><td><p>VOC_NOX_TRANS</p></td>
<td><p>&gt;= 0.0 (default is 0.35)</p></td>
<td><p>value of Prod H2O2 over Prod HNO3 less than where ISAM_VOC_CASE weights are used. Otherwise, ISAM_NOX_CASE weights are used. VOC_NOX_TRANS only used if ISAM_O3_WEIGHT equal 5.</p></td>
</tr>
</tbody>
</table>
</div>
<p>Additionally, ISAM can track emissions confined to geographic regions.  This functionality can be enabled through CMAQ’s <code class="docutils literal notranslate"><span class="pre">RegionsRegistry</span></code> set in the <code class="docutils literal notranslate"><span class="pre">CMAQ_Control_DESID</span></code> namelist (Appendix B.4) and is discussed further below.</p>
<section id="isam-and-bidirectional-nh3-exchange">
<h3>ISAM and bidirectional NH<sub>3</sub> exchange<a class="headerlink" href="#isam-and-bidirectional-nh3-exchange" title="Link to this heading">#</a></h3>
<p>ISAM in CMAQ v5.3 supports bidirectional NH<sub>3</sub> exchange using both M3Dry and STAGE deposition options. To run with this option the AMMONIUM species class must be set in the ISAM control file</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TAG</span> <span class="n">CLASSES</span>     <span class="o">|</span><span class="n">AMMONIUM</span>
</pre></div>
</div>
<p>and the ABFLUX must be set in the run script.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setenv</span> <span class="n">CTM_ABFLUX</span> <span class="n">Y</span>          <span class="c1">#&gt; ammonia bi-directional flux for in-line deposition</span>

</pre></div>
</div>
<p>Setting these options will automatically set the BID tag for model output. Modeled species output with the BID tag represent the influence of NH<sub>3</sub> emissions from fertilizer and biogenic NH<sub>3</sub> emission sources. Biogenic NH<sub>3</sub> emissions include the evasion of NH<sub>3</sub> from non-agricultural vegetation and soil NH<sub>4</sub> pools as parameterized in the STAGE or M3Dry models.</p>
</section>
<section id="isam-run-time-options-for-gas-chemistry-and-ozone-production">
<h3>ISAM run-time options for gas chemistry and ozone production<a class="headerlink" href="#isam-run-time-options-for-gas-chemistry-and-ozone-production" title="Link to this heading">#</a></h3>
<p>In the runtime table, the last four rows deal with ISAM’s method for apportioning source contributions from gas chemistry. They weight specific species that are chemical reactants so a reaction’s product are totally apportioned to the weighted reactant. If both reactants are weighted, products are equally apportioned between reactants. Note that the unmodified method always equally apportions products. The changes seek to isolate sources that emit or secondary produce the weighted reactants because their sources are controllable or deemed responsible for deteriorating air quality.</p>
<p>The weighting schemes focus on apportioning NOx and ozone concentrations so weighted species include several reactive nitrogen compounds, oxygenated VOCs, organic peroxy radicals and operators. A new runtime option, ISAM_O3_WEIGHTS, determines what species are weighted. The below two tables define what different values set for ISAM_O3_WEIGHTS. The first define option values 1 thru 4. Option 1 reproduces results from the unmodified code. The second table describes option 5 that toggles between two weight settings listed in the first table.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>Species</strong></p></th>
<th class="head text-center"><p><strong>Option 1</strong></p></th>
<th class="head text-center"><p><strong>Option 2</strong></p></th>
<th class="head text-center"><p><strong>Option 3</strong></p></th>
<th class="head text-left"><p><strong>Option 4</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>NO</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>YES</p></td>
<td class="text-center"><p>YES</p></td>
<td class="text-left"><p>NO</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>NO2</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>YES</p></td>
<td class="text-center"><p>YES</p></td>
<td class="text-left"><p>NO</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>NO3</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>YES</p></td>
<td class="text-center"><p>YES</p></td>
<td class="text-left"><p>NO</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>HONO</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>YES</p></td>
<td class="text-center"><p>YES</p></td>
<td class="text-left"><p>NO</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>ANO3(I or J)</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>YES</p></td>
<td class="text-center"><p>YES</p></td>
<td class="text-left"><p>NO</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>HCHO</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>YES</p></td>
<td class="text-left"><p>YES</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>CH3CHO</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>YES</p></td>
<td class="text-left"><p>YES</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Higher Aldehydes</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>YES</p></td>
<td class="text-left"><p>YES</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Acetone</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>YES</p></td>
<td class="text-left"><p>YES</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Lumped Ketones</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>YES</p></td>
<td class="text-left"><p>YES</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>Isoprene peroxy radical</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>YES</p></td>
<td class="text-left"><p>YES</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Acetyl peroxy radicals</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>YES</p></td>
<td class="text-left"><p>YES</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>peroxy operators(such as cb6’s XO2 and XO2H)</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>NO</p></td>
<td class="text-center"><p>YES</p></td>
<td class="text-left"><p>YES</p></td>
</tr>
</tbody>
</table>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>Option 5 Algorithm</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>IF( (H2O2 production)/(HNO3 Production) &gt; VOC_NOX_TRANS){ISAM_NOX_CASE}else{ISAM_VOC_CASE}</p></td>
</tr>
</tbody>
</table>
</div>
<p>The runtime options, ISAM_NOX_CASE and ISAM_VOC_CASE, determine the two settings. Toggling is determined by whether the cell grid’s ozone production has NOx or VOC limiting conditions. Option 5 uses H2O2 production over HNO3 production (see appendix A in Sillman (1995)) whether former or latter condition exists. Sillman (1995) states that VOC limiting exist when the ratio is less than 0.35 but the ratio’s transition value is uncertain (Tonnesen and Dennis, 2000a and 2000b) so a final runtime option sets the transition value,  VOC_NOX_TRANS. Note that all the repositories run-scripts include the below commands setting the new ISAM options using their default values.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>   #&gt; Options used to favor tracked species in reaction for Ozone-NOx chemistry
   setenv ISAM_O3_WEIGHTS 5   # weights for tracked species Default is 5
                              #     OPTIONS
                              # 1 does not weight any species
                              # 2 weights NOx and subset of NOz species
                              # 3 uses with from option 2 plus weight OVOC species, organic radicals and operators
                              # 4 weight OVOC species, organic radicals and operators
                              # 5 toggles between two wieghting set based on VOC and NOx limiting ozone production
   # Below options only used if ISAM_O3_WEIGHTS set to 5
   setenv ISAM_NOX_CASE  2    # weights for tracked species when ozone production is NOx limiting. Default is 2
   setenv ISAM_VOC_CASE  4    # weights for tracked species when ozone production is VOC limiting. Default is 4
   setenv VOC_NOX_TRANS  0.35 # value of Prod H2O2 over Prod HNO3 less than where
                              # ISAM_VOC_CASE weights are used. Otherwise, ISAM_NOX_CASE
                              # weights are used. Default is 0.35
</pre></div>
</div>
</section>
<section id="isam-control-file-sa-iolist">
<h3>11.3.1 ISAM control file (SA_IOLIST)<a class="headerlink" href="#isam-control-file-sa-iolist" title="Link to this heading">#</a></h3>
<p>The ISAM <code class="docutils literal notranslate"><span class="pre">SA_IOLIST</span></code> is a text file used to configure which tag classes, emissions streams, and source regions the model will track.  An example of this file, <code class="docutils literal notranslate"><span class="pre">isam_control.txt</span></code>, is provided in $CMAQ_HOME/CCTM/scripts.  The order and formating of this file must be kept intact, but it does allow for insertion of comment lines.</p>
<p>Each ISAM simulation requires the specification of the <code class="docutils literal notranslate"><span class="pre">TAG</span> <span class="pre">CLASSES</span></code> that the user desires to apportion.  The full list of available tag classes (e.g. <code class="docutils literal notranslate"><span class="pre">SULFATE</span></code>, <code class="docutils literal notranslate"><span class="pre">NITRATE</span></code>, <code class="docutils literal notranslate"><span class="pre">AMMONIUM</span></code>, <code class="docutils literal notranslate"><span class="pre">EC</span></code>, <code class="docutils literal notranslate"><span class="pre">OC</span></code>, <code class="docutils literal notranslate"><span class="pre">VOC</span></code>, <code class="docutils literal notranslate"><span class="pre">PM25_IONS</span></code>, <code class="docutils literal notranslate"><span class="pre">OZONE</span></code>, <code class="docutils literal notranslate"><span class="pre">OA_TOT</span></code>, or <code class="docutils literal notranslate"><span class="pre">PM_TOT</span></code>) and the species associated with each of these are provided in section 11.1.  One or more of these tag classes must be specified in <code class="docutils literal notranslate"><span class="pre">SA_IOLIST</span></code>.  Multiple tag classes are comma delimited. Incorrectly specified choices for this field will cause a model crash.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TAG</span> <span class="n">CLASSES</span>     <span class="o">|</span><span class="n">OZONE</span><span class="p">,</span> <span class="n">SULFATE</span>
</pre></div>
</div>
<p>After setting tag classes for the simulation, information for one or more tags is required. Each individual tag will track the species from the specified <code class="docutils literal notranslate"><span class="pre">TAG</span> <span class="pre">CLASSES</span></code> and has its own set of three options in the control file.  The first option is the name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TAG</span> <span class="n">NAME</span>        <span class="o">|</span><span class="n">EGU</span>
</pre></div>
</div>
<p>It is recommended that the text string for the tag name be kept short (three characters or less) in order to accommodate the longer species names from some chemical mechanisms in the ISAM output files.  When a ‘TAG NAME’ is specified that is too long to accomodate every tagged CMAQ species name and the appended tag name, the resulting ISAM species name may not be able to be written to output files correctly, due to 16 character limit for variable names in IOAPI.  For example, ‘BUTADIENE13_EGU’ would work, because it is 15 characters, but ‘BUTADIENE13_EGUT1’ would fail at 17 characters.</p>
<p>The second option is the comma delimited list of regions to track with this tag.  The keyword ‘EVERYWHERE’ is used to track domain-wide emissions.  To track region-constrained emissions, variable names from the regions file specified in the <code class="docutils literal notranslate"><span class="pre">CMAQ_Control_DESID</span></code> namelist are used instead of the “EVERYWHERE’ keyword. The regions file requirements are identical to the optional file used to scale emissions in predetermined geographical areas. See <a class="reference internal" href="Appendix/CMAQ_UG_appendixB_emissions_control.html#b4-applying-masks-for-spatial-dependence"><span class="std std-ref">Appendix B.4</span></a> for further details on the regions file, including how to download an example file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">REGION</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>       <span class="o">|</span><span class="n">EVERYWHERE</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">REGION</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>       <span class="o">|</span><span class="n">NC</span><span class="p">,</span> <span class="n">SC</span><span class="p">,</span> <span class="n">GA</span>
</pre></div>
</div>
<p>Finally, the emissions streams labels are required as the third option in the control file.  Labels correspond to emissions and other input streams set in build and run scripts for the base CMAQ simulation. Additionally, it is possible to specify ‘PVO3’ as a stream label in order to track contribution to concentrations from upper layer injections due to potential vorticity calculations.  This option also requires enabling the corresponding run script variable to support these calculations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">EMIS</span> <span class="n">STREAM</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>  <span class="o">|</span><span class="n">PT_EGU</span><span class="p">,</span> <span class="n">PT_NONEGU</span>
</pre></div>
</div>
<p>The final line in the control file needs to be kept unchanged in order to aid the file parser in reading this file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ENDLIST</span> <span class="n">eof</span>
</pre></div>
</div>
<p>In addition to the user-specified list, ISAM will alway track and output three additional default tags with every simulation and the BID tag if the simulation includes both bidirectional NH<sub>3</sub> and the ‘AMMONIUM’ species class (note, that at least one valid user-specified tag must be defined, so a minimum of 4 tags are required):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ICO</span> <span class="o">-</span> <span class="n">contribution</span> <span class="kn">from</span> <span class="nn">initial</span> <span class="n">conditions</span> <span class="n">specified</span> <span class="k">for</span> <span class="n">the</span> <span class="n">first</span> <span class="n">day</span> <span class="n">of</span> <span class="n">the</span> <span class="n">simulation</span>
<span class="n">BCO</span> <span class="o">-</span> <span class="n">contribution</span> <span class="kn">from</span> <span class="nn">boundary</span> <span class="n">conditions</span> <span class="n">throughout</span> <span class="n">the</span> <span class="n">simulation</span>
<span class="n">OTH</span> <span class="o">-</span> <span class="n">contribution</span> <span class="kn">from</span> <span class="nn">all</span> <span class="n">non</span><span class="o">-</span><span class="n">tagged</span> <span class="n">emissions</span> <span class="n">streams</span> <span class="ow">and</span> <span class="n">other</span> <span class="n">processes</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">model</span><span class="o">.</span>
<span class="n">BID</span> <span class="o">-</span> <span class="n">contribution</span> <span class="kn">from</span> <span class="nn">bidirectional</span> <span class="n">NH3</span> <span class="n">exchange</span> 
</pre></div>
</div>
<p>Please, note that, currently, ISAM results for the same user defined tag may differ depending on the overall configuration and content of the ISAM control file.  This weakness of the method is detailed in the last section of the <a class="reference download internal" download="" href="../../_downloads/77ba2f736e07d20a60d154bafa95e4b9/CMAQ_ISAM_Chemistry_Supplemental_Equations.pdf"><span class="xref download myst">ISAM Chemistry Supplement</span></a>.  Generally, tracking a larger number of tags produces more consistent apportionment results.</p>
<section id="defining-isam-tags-for-in-line-sources">
<h4>Defining ISAM Tags for In-line Sources.<a class="headerlink" href="#defining-isam-tags-for-in-line-sources" title="Link to this heading">#</a></h4>
<p>The CMAQ model allows several types of emissions that are calculated in-line or during a model simulation instead of provided by the user as inputs. A simulation can use all of these inline emissions and ISAM can calculate apportionment from these sources. The former is done by setting appropriate emissions options in the CMAQ runscript. For ISAM to calculate apportionment for an in-line source, the isam control file needs to define a tagname using the correct stream name.  The below table lists currently supported inline emissions streams in CMAQ:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Emission Stream Name</strong></p></th>
<th class="head"><p><strong>Inline Emissions Source</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>BIOG</p></td>
<td><p>Biogenic Emissions (BEIS)</p></td>
</tr>
<tr class="row-odd"><td><p>MIOG</p></td>
<td><p>Biogenic Emission (MEGAN)</p></td>
</tr>
<tr class="row-even"><td><p>MGEGM</p></td>
<td><p>Marine Gas Emissions</p></td>
</tr>
<tr class="row-odd"><td><p>LTNG</p></td>
<td><p>Lightning NO Emissions</p></td>
</tr>
<tr class="row-even"><td><p>ASEA</p></td>
<td><p>Sea Spray Aerosol Emissions</p></td>
</tr>
<tr class="row-odd"><td><p>DUST</p></td>
<td><p>Wind-Blown Dust Emissions</p></td>
</tr>
<tr class="row-even"><td><p>PVO3</p></td>
<td><p>Potential Vorticity Incursion*</p></td>
</tr>
</tbody>
</table>
</div>
<p>*Although it is not an emission stream, it is possible to tag the ozone incursions at the top of the simulated volume if the potential vorticity option <code class="docutils literal notranslate"><span class="pre">CTM_PVO3</span></code> is activated in the run script.</p>
</section>
<section id="interpretation-of-oth-tag">
<h4>Interpretation of ‘OTH’ tag<a class="headerlink" href="#interpretation-of-oth-tag" title="Link to this heading">#</a></h4>
<p>The OTH tag (e.g.“O3_OTH” in the ISAM benchmark) represents concentrations for that species attributed to 1) all other emissions streams, 2) precursor species not included in the specified tag class(es), and 3) other processes in the model.</p>
<p>For item 1), this includes internally calculated emissions that a user decides to exclude from the control file (perhaps to reduce computational cost of running with tags that are not of interest to a particular application). These are things like online biogenics, online lightning, dust, etc.</p>
<p>For item 2), these are some secondarily produced intermediate species that have minor impact on ozone production.</p>
<p>For item 3), these are processes in the model that create a given species but not from the emissions streams that can be specified with the control file.  For example, ‘O3_OTH’ includes ozone that is produced from background methane that is specified in the model as a constant.</p>
<p>Finally, ISAM is an approximation for attribution. In the formulation, assumptions are made about which species are most important in the chemical formuation of the species being studied.  For example in cb6r3 based mechanisms, peroxyl radicals from aromatic compounds affect ozone production by a small amount so ISAM neglects their contribution. The contribution to ozone from species not included in the ISAM formulation will go into ‘O3_OTH’, even if the emission source of these species is included in the control file.</p>
</section>
</section>
</section>
<section id="isam-benchmark">
<h2>11.4 ISAM Benchmark<a class="headerlink" href="#isam-benchmark" title="Link to this heading">#</a></h2>
<p>See the <a class="reference internal" href="Tutorials/CMAQ_UG_tutorial_ISAM.html"><span class="std std-doc">CMAQ-ISAM Benchmark Tutorial</span></a> for step-by-step instructions for running the 2 day benchmark case.  The input files for the CMAQv5.5 ISAM benchmark case are the same as the benchmark inputs for the base model. Output source apportionment files associated with the sample <code class="docutils literal notranslate"><span class="pre">isam_control.txt</span></code> provided in this release package are included in the benchmark outputs for the base model. The tutorial also provides example instructions for post-processing ISAM output for individual species contained in the SA_ACONC_1 output file into aggregate species like NOx or PM2.5 using the <a class="reference internal" href="../../POST/combine/README.html"><span class="std std-doc"><code class="docutils literal notranslate"><span class="pre">combine</span></code></span></a> utility and customized <code class="docutils literal notranslate"><span class="pre">SPECIES_DEF</span></code> species definition files. Note that the <a class="reference internal" href="Appendix/CMAQ_UG_appendixF_elmo_output.html"><span class="std std-doc">Explicit and Lumped Model Output (ELMO) module</span></a> available for aggregating base model concentrations does not currently support the aggregation of ISAM species within CMAQ, necessitating a customized post-processing workflow.</p>
</section>
<section id="references">
<h2>11.5 References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<p>Kwok, R.H.F, Napelenok, S.L., &amp; Baker, K.R. (2013). Implementation and evaluation of PM2.5 source contribution analysis in a photochemical model. Atmospheric Environment, 80, 398–407 <a class="reference external" href="https://doi.org/10.1016/j.atmosenv.2013.08.017" rel="noreferrer" target="_blank">doi:10.1016/j.atmosenv.2013.08.017 <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a>.</p>
<p>Kwok, R.H.F, Baker, K.R., Napelenok, S.L., &amp; Tonnesen, G.S. (2015). Photochemical grid model implementation of VOC, NOx, and O3 source apportionment. Geosci. Model Dev., 8, 99-114. <a class="reference external" href="https://doi.org/10.5194/gmd-8-99-2015" rel="noreferrer" target="_blank">doi:10.5194/gmd-8-99-2015 <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a>.</p>
<p>Sillman, Sanford. (1995). The use of NOy, H2O2, and HNO3 as indicators for ozone-NOx-hydrocarbon sensitivity in urban locations. Journal of Geophysical Research. 1001. 14175-14188.</p>
<p>Tonnesen, G.S. &amp; Dennis, R.L. (2000a). Analysis of radical propagation efficiency to assess ozone sensitivity to hydrocarbons and NOx. 1. Long-lived species as indicators of ozone concentration sensitivity. Journal of Geophysical Research. 105. 9213-9225.</p>
<p>Tonnesen, G.S. &amp; Dennis, R.L. (2000b). Analysis of radical propagation efficiency to assess ozone sensitivity to hydrocarbons and NOx. 2. Long-lived species as indicators of ozone concentration sensitivity. Journal of Geophysical Research. 105. 9227-9241.</p>
<p><strong>Contact</strong></p>
<p><a class="reference external" href="mailto:napelenok&#46;sergey&#37;&#52;&#48;epa&#46;gov" rel="noreferrer" target="_blank">Sergey L<span>&#46;</span> Napelenok <svg version="1.1" width="1.0em" height="1.0em" viewBox="0 0 16 16" aria-hidden="true" style="display: inline-block; vertical-align: middle; fill: currentColor;"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a>, Computational Exposure Division, U.S. EPA</p>
<!-- BEGIN COMMENT -->
<p><a class="reference internal" href="CMAQ_UG_ch10_HDDM-3D.html"><span class="std std-doc">&lt;&lt; Previous Chapter</span></a> - <a class="reference internal" href="README.html"><span class="std std-doc">Home</span></a> - <a class="reference internal" href="CMAQ_UG_ch12_sulfur_tracking.html"><span class="std std-doc">Next Chapter &gt;&gt;</span></a><br>
CMAQv5.5 User’s Guide <br></p>
<!-- END COMMENT -->
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="CMAQ_UG_ch10_HDDM-3D.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">10. Decoupled Direct Method in Three Dimensions (CMAQ-DDM-3D)</p>
      </div>
    </a>
    <a class="right-next"
       href="CMAQ_UG_ch12_sulfur_tracking.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">12. Sulfur Tracking Method</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">11.1 Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-instructions">11.2 Build Instructions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-instructions">11.3 Run Instructions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#isam-and-bidirectional-nh3-exchange">ISAM and bidirectional NH<sub>3</sub> exchange</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#isam-run-time-options-for-gas-chemistry-and-ozone-production">ISAM run-time options for gas chemistry and ozone production</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#isam-control-file-sa-iolist">11.3.1 ISAM control file (SA_IOLIST)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-isam-tags-for-in-line-sources">Defining ISAM Tags for In-line Sources.</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-of-oth-tag">Interpretation of ‘OTH’ tag</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#isam-benchmark">11.4 ISAM Benchmark</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">11.5 References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>